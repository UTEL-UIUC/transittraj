% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/avl_cleaning.R
\name{make_monotonic}
\alias{make_monotonic}
\title{Corrects distance observations, and optionally speeds, to be weakly or strictly monotonic.}
\usage{
make_monotonic(
  distance_df,
  correct_speed = FALSE,
  add_distance_error = 0,
  return_changes = FALSE
)
}
\arguments{
\item{distance_df}{Dataframe of linear AVL distances. Must include: "trip_id_performed", "event_timestamp", numeric "distance", and numeric "speed".}

\item{correct_speed}{Optional. Boolean, should speeds be corrected to meet adjusted distances and Fritsch-Carlson conditions? Default is FALSE.}

\item{add_distance_error}{Optional. If non-zero, "flat" periods will be identified and given a slight upward slope. Each "flat" observation will be adjusted by this amount forwards, in meters. Speeds will also be made non-zero, by this amount divided by the time change between observations. Default is 0.}
}
\value{
The input distance_df, with distance (and optionally speed) columns replaced with corrected, monotone versions.
}
\description{
Due to error in GPS position and speed measurements, raw AVL data is often not monotonic, creating difficulties for advanced analyses.
This functions presents a variety of options to correct data. Observations which move backwards are "moved up" to maximum observed distance before that timepoint.
Optionally, "flat" segments are identified and given a slight upward slope, resulting in a strictly monotone, one-to-one trajectory.
If making this adjustment (add_distance_error > 0), be sure to choose a very small distance. Large distances
Optionally, speeds can also be corrected. If chosen, two corrections will be applied:
First, on all points in which distances have been adjusted, the speed will be updated to the maximum of the observed speed and the implied speed by the corrected distance;
and second, to meet the Fritsch-Carlson conditions for the fitting of a monotone spline.
}
